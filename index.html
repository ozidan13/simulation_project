<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Engineering Systems Simulation</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@2.0.7/css/boxicons.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <header>
        <div class="container">
            <h1>Engineering Systems Simulation</h1>
        </div>
    </header>

    <div class="container">
        <nav class="nav-tabs">
            <button class="tab-btn active" onclick="switchTab('theory')">System Theory</button>
            <button class="tab-btn" onclick="switchTab('single-sim')">Single-server Queue Simulation </button>
            <button class="tab-btn" onclick="switchTab('multi-sim')">Multi-server Queue Simulation </button>
            <button class="tab-btn" onclick="switchTab('inventory')">Inventory Simulation </button>
            <button class="tab-btn" onclick="switchTab('rng')">Random Number Generator</button>
        </nav>

        <!-- 1. QUEUING THEORY -->
        <!-- 1. MATHEMATICAL MODELS & ALGORITHMS (THEORY) -->
        <section id="theory" class="section active">
            <div class="grid-2">
                <!-- QUEUING ANALYTICS -->
                <div class="card">
                    <h2><i class='bx bx-calculator'></i> Queuing Formulas (Analytic)</h2>
                    <p class="subtitle">Mathematical laws for Single-Server (M/M/1) systems.</p>

                    <div class="formula-block">
                        <div class="formula-row">
                            <span class="var">λ (Lambda)</span>
                            <span class="desc">Arrival Rate (cust/time)</span>
                        </div>
                        <div class="formula-row">
                            <span class="var">μ (Mu)</span>
                            <span class="desc">Service Rate (cust/time)</span>
                        </div>
                    </div>

                    <h3>Performance Laws</h3>
                    <div class="formula-list">
                        <div class="f-item">
                            <span class="f-name">Utilization (R):</span>
                            <span class="f-math">R = λ / μ</span>
                        </div>
                        <div class="f-item">
                            <span class="f-name">Prob(Idle) (P₀):</span>
                            <span class="f-math">P₀ = 1 - R</span>
                        </div>
                        <div class="f-item">
                            <span class="f-name">Avg in System (Lₛ):</span>
                            <span class="f-math">Lₛ = λ / (μ - λ)</span>
                        </div>
                        <div class="f-item">
                            <span class="f-name">Avg in Queue (Lq):</span>
                            <span class="f-math">Lq = λ² / [μ(μ - λ)]</span>
                        </div>
                        <div class="f-item">
                            <span class="f-name">Wait in System (Wₛ):</span>
                            <span class="f-math">Wₛ = 1 / (μ - λ)</span>
                        </div>
                        <div class="f-item">
                            <span class="f-name">Wait in Queue (Wq):</span>
                            <span class="f-math">Wq = λ / [μ(μ - λ)]</span>
                        </div>
                    </div>

                    <h3>Cost Model Law</h3>
                    <div class="formula">T.C. = (C₁ × C) + (C₂ × Lₛ)</div>
                    <p style="font-size:0.85rem; color:var(--text-muted);">
                        Where <strong>C₁</strong> = Server Cost, <strong>C</strong> = Num Servers, <strong>C₂</strong> =
                        Wait Cost.
                    </p>
                </div>

                <div class="card">
                    <h2>Analytical Calculator</h2>
                    <p>Metrics for single-server (Poisson arrivals, Exponential service).</p>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div><label>λ (Arr):</label><input type="number" id="calc-lambda" value="4"
                                oninput="calculateAnalytical()"></div>
                        <div><label>μ (Svc):</label><input type="number" id="calc-mu" value="5"
                                oninput="calculateAnalytical()"></div>
                    </div>

                    <div class="formula" id="analytical-results">Results will appear here...</div>
                    <p id="traffic-warning" style="color:var(--accent-danger); display:none; font-weight:bold;">⚠️
                        System Unstable: λ ≥ μ</p>

                    <h3>Cost Inputs</h3>
                    <div style="display:flex; gap:15px;">
                        <div style="flex:1"><label>Server Cost (C1):</label><input type="number" id="cost-c1" value="10"
                                oninput="calculateAnalytical()"></div>
                        <div style="flex:1"><label>Wait Cost (C2):</label><input type="number" id="cost-c2" value="5"
                                oninput="calculateAnalytical()"></div>
                    </div>
                    <h3 id="total-cost-display" style="color:var(--accent-success); border:none; margin-top:20px;"></h3>
                </div>
            </div>
        </section>

        <!-- 2. SINGLE SERVER SIMULATION -->
        <section id="single-sim" class="section">
            <!-- Inserted: Simulation Logic (The Mesh) -->
            <div class="card" style="margin-bottom:25px;">
                <h2><i class='bx bx-list-ol'></i> Simulation Logic (The Mesh)</h2>
                <div class="grid-2">
                    <div>
                        <h3>1. Arrival Logic</h3>
                        <div class="step-box">
                            <div class="step">
                                <span class="step-num">01</span>
                                <div class="step-content">
                                    <strong>Generate Interarrival (IA):</strong>
                                    <div class="code">IA[i] = Random(Min, Max)</div>
                                </div>
                            </div>
                            <div class="step">
                                <span class="step-num">02</span>
                                <div class="step-content">
                                    <strong>Calculate Clock Time:</strong>
                                    <div class="code">ArrivalClock[i] = ArrivalClock[i-1] + IA[i]</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3>2. Service Logic</h3>
                        <div class="step-box">
                            <div class="step">
                                <span class="step-num">03</span>
                                <div class="step-content">
                                    <strong>Start Service:</strong>
                                    <div class="code">Start[i] = max(ArrivalClock[i], End[i-1])</div>
                                </div>
                            </div>
                            <div class="step">
                                <span class="step-num">04</span>
                                <div class="step-content">
                                    <strong>End Service:</strong>
                                    <div class="code">End[i] = Start[i] + ServiceTime[i]</div>
                                </div>
                            </div>
                        </div>

                        <h3>3. Performance Logic</h3>
                        <div class="step-box">
                            <div class="step">
                                <span class="step-num">05</span>
                                <div class="step-content">
                                    <strong>Wait Time:</strong>
                                    <div class="code">Wait[i] = Start[i] - ArrivalClock[i]</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid-2">
                <div class="card">
                    <h2>Simulation Setup</h2>
                    <p>Configure the parameters. Clock advances based on Interarrival Times.</p>

                    <label>Number of Customers:</label>
                    <input type="number" id="sim-count" value="20">

                    <label>Interarrival Time (Min-Max):</label>
                    <div style="display:flex; gap:10px;">
                        <input type="number" id="arrival-min" value="1" placeholder="Min">
                        <input type="number" id="arrival-max" value="8" placeholder="Max">
                    </div>

                    <label>Service Time (Min-Max):</label>
                    <div style="display:flex; gap:10px;">
                        <input type="number" id="service-min" value="1" placeholder="Min">
                        <input type="number" id="service-max" value="6" placeholder="Max">
                    </div>

                    <button class="action-btn" onclick="runSingleServerSim()">Run Simulation</button>
                </div>

                <div class="card">
                    <h2>Performance Stats</h2>
                    <div class="grid-2" style="grid-template-columns: 1fr 1fr; margin-top: 10px;">
                        <div class="stat-box">
                            <div class="stat-val" id="ss-avg-wait">0.0</div>
                            <div class="stat-label">Avg Wait (min)</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-val" id="ss-util">0%</div>
                            <div class="stat-label">Utilization</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-val" id="ss-idle">0</div>
                            <div class="stat-label">Total Idle (min)</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-val" id="ss-prob-wait">0%</div>
                            <div class="stat-label">Wait Prob.</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Simulation Mesh Table</h2>
                <div class="table-container">
                    <table id="ss-table">
                        <thead>
                            <tr>
                                <th>Cust</th>
                                <th>Interarrival</th>
                                <th>Arr. Clock</th>
                                <th>Svc Time</th>
                                <th>Svc Start</th>
                                <th>Svc End</th>
                                <th>Wait Queue</th>
                                <th>Time System</th>
                                <th>Idle Server</th>
                            </tr>
                        </thead>
                        <tbody><!-- JS populates this --></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- 3. MULTI-SERVER SIMULATION -->
        <section id="multi-sim" class="section">
            <div class="card" style="margin-bottom:25px;">
                <h2><i class='bx bx-sitemap'></i> Multi-Server Laws (M/M/c)</h2>
                <div class="grid-2">
                    <div>
                        <h3>System Notation</h3>
                        <div class="formula-block">
                            <div class="formula-row">
                                <span class="var">c</span>
                                <span class="desc">Number of Parallel Servers</span>
                            </div>
                            <div class="formula-row">
                                <span class="var">Disc</span>
                                <span class="desc">Queue Discipline (e.g. FCFS)</span>
                            </div>
                        </div>

                        <h3>Generic Performance Laws</h3>
                        <ul class="rule-list">
                            <li><strong>Utilization (ρ):</strong> λ / (c × μ)</li>
                            <li><strong>Stable Condition:</strong> λ < (c × μ)</li>
                        </ul>
                    </div>
                    <div>
                        <h3>Able & Baker Problem Rules</h3>
                        <p class="subtitle" style="margin-top:0;">Heterogeneous Servers (Different Speeds)</p>
                        <div class="step-box">
                            <div class="step">
                                <span class="step-num">Rule 1</span>
                                <div class="step-content">
                                    <strong>Check Availability:</strong>
                                    <small>Is Able free? Is Baker free?</small>
                                </div>
                            </div>
                            <div class="step">
                                <span class="step-num">Rule 2</span>
                                <div class="step-content">
                                    <strong>Priority Selection:</strong>
                                    <small>If Able is free → Select <strong>Able</strong>.</small>
                                    <small>If Able busy & Baker free → Select <strong>Baker</strong>.</small>
                                    <small>If both busy → Wait for <strong>earliest</strong> finish.</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Simulation Control</h2>
                <p style="margin-bottom: 20px;">Run the specific "Able & Baker" scenario (50 Customers).
                </p>

                <button class="action-btn" onclick="runMultiServerSim()">Run Able & Baker Simulation (50 Pax)</button>
            </div>

            <div class="grid-2">
                <div class="card">
                    <h3>Server Able Stats</h3>
                    <div class="stat-box">
                        <div class="stat-val" id="ms-able-util">0%</div>
                        <div class="stat-label">Utilization</div>
                    </div>
                </div>
                <div class="card">
                    <h3>Server Baker Stats</h3>
                    <div class="stat-box">
                        <div class="stat-val" id="ms-baker-util">0%</div>
                        <div class="stat-label">Utilization</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Track Record</h2>
                <div class="table-container">
                    <table id="ms-table">
                        <thead>
                            <tr>
                                <th>Cust</th>
                                <th>Arrival Clock</th>
                                <th>Server</th>
                                <th>Start</th>
                                <th>Duration</th>
                                <th>End</th>
                                <th>Wait</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- 4. INVENTORY SIMULATION -->
        <section id="inventory" class="section">
            <div class="card">
                <h2><i class='bx bx-package'></i> Inventory Logic (M, N)</h2>
                <p class="subtitle">Periodic Review System Rules & Mathematical Law</p>

                <div class="grid-2">
                    <div>
                        <ul class="rule-list">
                            <li><strong>Review Period (N):</strong> Check inventory every N days.</li>
                            <li><strong>Target Level (M):</strong> Max inventory capacity/Order up to level.</li>
                        </ul>
                    </div>
                    <div>
                        <h3>Ordering Rule (The Law)</h3>
                        <div class="formula">Order Qty (Q) = M - EndingInv + Shortage</div>
                        <p style="font-size:0.9rem; color:var(--text-muted);">
                            Order Quantity (Q) is calculated <strong>only on review days</strong>. Order is placed to
                            top up inventory to level M.
                        </p>
                    </div>
                </div>
            </div>

            <div class="grid-2">
                <div class="card">
                    <h2>(M, N) Inventory Policy</h2>
                    <p>Review every <strong>N</strong> days. Order up to <strong>M</strong>. <br>Order = M - EndInv +
                        Shortage.</p>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div><label>Std Level (M):</label><input type="number" id="inv-m" value="11"></div>
                        <div><label>Review (N):</label><input type="number" id="inv-n" value="5"></div>
                    </div>
                    <label>Initial Inventory:</label>
                    <input type="number" id="inv-start" value="3">

                    <button class="action-btn" onclick="runInventorySim()">Simulate 20 Days</button>
                </div>

                <div class="card">
                    <h3>Daily Levels Visualization</h3>
                    <div id="inv-chart" class="bar-chart">
                        <!-- Bars injected via JS -->
                    </div>
                    <div style="margin-top:10px; font-size:0.8rem; text-align:center; color:var(--secondary);">
                        Daily Ending Inventory
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Inventory Log</h2>
                <div class="table-container">
                    <table id="inv-table">
                        <thead>
                            <tr>
                                <th>Cycle</th>
                                <th>Day</th>
                                <th>Beg Inv</th>
                                <th>Demand</th>
                                <th>End Inv</th>
                                <th>Shortage</th>
                                <th>Order Qty</th>
                                <th>Lead Time</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- 5. RNG & TESTING -->
        <section id="rng" class="section">
            <div class="card" style="margin-bottom:25px;">
                <h2><i class='bx bx-dice-5'></i> RNG Laws & Algorithms</h2>
                <div class="grid-2">
                    <div>
                        <h3>Linear Congruential Generator (LCG)</h3>
                        <div class="formula">Zᵢ = (a × Zᵢ₋₁ + c) mod m</div>
                        <div class="formula-list">
                            <div class="f-item"><span class="f-name">Modulus (m):</span> Range limit</div>
                            <div class="f-item"><span class="f-name">Multiplier (a):</span> Scaling factor</div>
                            <div class="f-item"><span class="f-name">Increment (c):</span> Shift factor</div>
                        </div>
                    </div>
                    <div>
                        <h3>Uniformity Test (Chi-Square)</h3>
                        <div class="formula">χ² = ∑ [ (Oᵢ - Eᵢ)² / Eᵢ ]</div>
                        <ul class="rule-list">
                            <li><strong>Null Hypothesis (H₀):</strong> numbers are Uniform.</li>
                            <li><strong>Decision:</strong> Reject H₀ if χ² > Critical Value.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="grid-2">
                <div class="card">
                    <h2>Random Number Generator (LCG)</h2>
                    <div class="formula">Z<sub>i</sub> = (aZ<sub>i-1</sub> + c) mod m</div>
                    <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px;">
                        <div><label>Mult (a)</label><input type="number" id="lcg-a" value="5"></div>
                        <div><label>Inc (c)</label><input type="number" id="lcg-c" value="3"></div>
                        <div><label>Mod (m)</label><input type="number" id="lcg-m" value="16"></div>
                    </div>
                    <label>Seed (Z<sub>0</sub>)</label><input type="number" id="lcg-seed" value="7">
                    <button class="action-btn" onclick="generateLCG()">Generate Sequence</button>
                    <div id="lcg-output"
                        style="margin-top:15px; font-family:'JetBrains Mono', monospace; word-break:break-all; color:var(--accent-purple);">
                    </div>
                </div>

                <div class="card">
                    <h2>Uniformity Test (Chi-Square)</h2>
                    <div class="formula">$\chi^2 = \sum \frac{(O_i - E_i)^2}{E_i}$</div>

                    <button class="action-btn" onclick="runChiSquare()">Run Test (100 Samples)</button>

                    <div id="chi-result" style="margin-top:15px; font-weight:bold;"></div>

                    <div class="table-container" style="max-height: 200px; margin-top: 15px;">
                        <table id="chi-table">
                            <thead>
                                <tr>
                                    <th>Interval</th>
                                    <th>Obs (Oi)</th>
                                    <th>Exp (Ei)</th>
                                    <th>Calc</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script src="script.js"></script>

</body>

</html>